<!DOCTYPE html>
<html>
<head>{include="includes"}
    <style TYPE="text/css">#activeLinklist,#activeLinklist i {background-color: #C93030!important;color:#FFFFFF!important;}</style>
</head>
<body>
<div id="pageheader">
    {include="page.header"}
</div>

<div id="linklist">

    {include="linklist.paging"}

    {if="count($links)==0"}
        <div id="searchcriteria">Nothing found.</i></div>
    {else}
        {if="$search_type=='fulltext'"}
            <div id="searchcriteria">{$result_count} results for <span id="searchcriteria_result">{$search_crits}</span></div>
        {/if}
        {if="$search_type=='tags'"}
            <div id="searchcriteria">{$result_count} results for tags
            {loop="search_crits"}
                <span class="linktag" title="Remove tag"> <a href="?removetag={$value|htmlspecialchars}">{$value|htmlspecialchars} <span id="searchcriteria_result"><i class="glyphicon glyphicon-remove"></i></span></a></span>
            {/loop}</div>
        {/if}
    {/if}
    <ul>
        {loop="links"}
        <li{if="$value.class"} class="{$value.class}"{/if}>
            <a id="{$value.linkdate|smallHash}"></a>
            <div class="thumbnail">{$value.url|thumbnail}</div>
            <div class="linkcontainer">
                {if="isLoggedIn()"}
                    <div class="linkeditbuttons">
                        <form method="GET" class="buttoneditform"><input type="hidden" name="edit_link" value="{$value.linkdate}"><input type="image" alt="Edit" src="inc/img/edit_icon.png" title="Edit" class="button_edit"></form><br>
                        <form method="POST" class="buttoneditform"><input type="hidden" name="lf_linkdate" value="{$value.linkdate}">
                        <input type="hidden" name="token" value="{$token}"><input type="hidden" name="delete_link"><input type="image" alt="Delete" src="inc/img/delete_icon.png" title="Delete" class="button_delete" onClick="return confirmDeleteLink();"></form>
                    </div>
                {/if}
                <span class="linktitle"><a href="{$redirector}{$value.url|htmlspecialchars}">{$value.title|htmlspecialchars}</a></span><br>
                        <span class="linkurl" title="Direct link"><i class="glyphicon glyphicon-link"></i> <a href="{$value.url|htmlspecialchars}">{$value.url|htmlspecialchars}</a></span>
                {if="$value.tags"}
                    <div class="linktaglist">
                    {loop="value.taglist"}<span class="linktag" title="Add tag"><i class="glyphicon glyphicon-tag"></i> <a href="?addtag={$value|urlencode}">{$value|htmlspecialchars}</a> </span> {/loop}
                    </div>
                {/if}
                <div class="linkdescription">{if="$value.description"}{$value.description}{/if}</div>
                {if="!$GLOBALS['config']['HIDE_TIMESTAMPS'] || isLoggedIn()"}
                    <span class="linkdate" title="Permalink"><i class="glyphicon glyphicon-time"></i> <a href="?{$value.linkdate|smallHash}">{$value.localdate|htmlspecialchars} - permalink</a> - </span>
                {else}
                    <span class="linkdate" title="Short link here"><i class="glyphicon glyphicon-time"></i> <a href="?{$value.linkdate|smallHash}">permalink</a> - </span>
                {/if}
                {if="$GLOBALS['config']['ARCHIVE_ORG']"}
                <span class="linkarchive"><a href="https://web.archive.org/web/{$value.url|htmlspecialchars}">archive</a> - </span>
                {/if}
                <div class="linkqrcode"><a href="http://qrfree.kaywa.com/?l=1&amp;s=8&amp;d={$scripturl|urlencode}%3F{$value.linkdate|smallHash}"
                    onclick="return showQrCode(this);" class="qrcode" data-permalink="{$scripturl}?{$value.linkdate|smallHash}"> <i class="glyphicon glyphicon-qrcode"></i></a></div><br>
                </div>

<div class="am-partagesocial"><i class="glyphicon glyphicon-share"></i>&nbsp; 
<a target="_blank" title="Diaspora*" href="http://sharetodiaspora.github.io/?url={$value.url|rawurlencode}&amp;title={$value.title|rawurlencode}" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;">diaspora*</a> &middot; 
<a target="_blank" title="Twitter" href="https://twitter.com/share?url={$value.url|rawurlencode}&amp;text={$value.title|rawurlencode(str_replace('|','-',$value.title));}" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=400,width=700');return false;">twitter</a> &middot; 
<a target="_blank" title="Facebook" href="https://www.facebook.com/sharer.php?u={$value.url|rawurlencode}&amp;t={$value.title|rawurlencode}" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=500,width=700');return false;">facebook</a> &middot; 
<a target="_blank" title="Google +" href="https://plus.google.com/share?url={$value.url|rawurlencode}&amp;hl=fr" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;">google+</a> &middot; 
<a target="_blank" title="LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&amp;url={$value.url|rawurlencode}&amp;title={$value.title|rawurlencode}" rel="nofollow" onclick="javascript:window.open(this.href, '','menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;">linkedin</a> &middot; 
<a target="_blank" title="Pinterest" href="http://pinterest.com/pin/create/button/?url={$value.url|rawurlencode}&amp;media={$value.url|rawurlencode}&amp;description={$value.title|rawurlencode}" rel="nofollow" onclick="javascript:window.open(this.href, '','menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=450,width=650');return false;">pinterest</a> &middot; 
<a target="_blank" title="Scoop.it" href="http://www.scoop.it/oexchange/share?url={$value.url|rawurlencode}&amp;title={$value.title|rawurlencode}" rel="nofollow" onclick="javascript:window.open(this.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=800px,width=1150px');return false;">scoop.it</a> &middot; 
<a target="_blank" title="Envoyer par mail" href="mailto:?subject={$value.title|rawurlencode}&amp;body={$value.url|rawurlencode}" rel="nofollow">courriel</a>
</div><br> 

        </li>
    {/loop}
    </ul>

    {include="linklist.paging"}

</div>

    {include="page.footer"}

<script>
// Remove any displayed QR-Code
function remove_qrcode()
{
    var elem = document.getElementById("permalinkQrcode");
    if (elem) elem.parentNode.removeChild(elem);
    return false;
}

function isCanvasSupported(){
    var elem = document.createElement('canvas');
    return !!(elem.getContext && elem.getContext('2d'));
}

// Show the QR-Code of a permalink (when the QR-Code icon is clicked).
function showQrCode(caller,loading)
{
    if( !isCanvasSupported() ) return true;

    // Dynamic javascript lib loading: We only load qr.js if the QR code icon is clicked:
    if (typeof(qr)=='undefined') // Load qr.js only if not present.
    {
        loading = typeof loading !== 'undefined' ? loading : false;
        if (!loading)  // If javascript lib is still loading, do not append script to body.
        {
            var element = document.createElement("script");
            element.src = "tpl/albinomouse-template/inc/js/qr-1.1.3.min.js";
            document.body.appendChild(element);
        }
        setTimeout(function() { showQrCode(caller,true);}, 200); // Retry in 200 milliseconds.
        return false;
    }

    // Remove previous qrcode if present.
    remove_qrcode();

    // Build the div which contains the QR-Code:
    var element = document.createElement('div');
    element.id="permalinkQrcode";

    // Make QR-Code div commit sepuku when clicked:
    element.addEventListener('click', remove_qrcode ); // Works on every canvas supported browser

    // Build the QR-Code:
    var image = qr.image({size: 8,value: caller.getAttribute('data-permalink')});
    if (image)
    {
        element.appendChild(image);
        element.innerHTML+= "<br>Click to close";
        caller.parentNode.appendChild(element);
    }
    else
    {
        element.innerHTML="Your browser does not seem to be HTML5 compatible.";
    }
    return false;
}
</script>
</body>
</html>
